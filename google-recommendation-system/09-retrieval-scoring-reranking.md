---
marp: true
---

# Retrieval, Scoring, and Re-ranking

---

## Retrieval

---

### Retrieval 이란?

**임베딩 모델을 만들었다고 생각해보자.
사용자가 주어졌을 때 추천할 아이템을 어떻게 결정할 것인가?**

* Matrix Factorization: 쿼리 (또는 사용자) 임베딩은 고정적으로 알고 있기 때문에 추천 시스템은 사용자 임베딩 행렬에서 이를 찾아보기만 하면 됨
* DNN: 요청이 들어오면 피쳐 벡터 $x$ 를 신경망에 보내서 쿼리 임베딩 $\psi(x)$ 를 연산함

---

### 작동 원리

![2d-retrieval bg right height:300](https://developers.google.com/machine-learning/recommendation/images/2Dretrieval.svg)

* 쿼리 임베딩 $q$ 가 주어졌을 때 임베딩 공간에서 $q$ 와 가까운 아이템 임베딩 $V_j$ 를 검색
  * 근접 이웃 문제
  * 예를 들어 유사도 점수 $s(q, V_j)$ 에 따라 최고점을 보인 $k$ 개의 아이템만 반환할 수 있음
* 관련 아이템 추천에 이와 유사한 방식을 적용할 수 있음
  * 현재 보고 있는 영상의 임베딩을 구하고
  * 이와 근접한 다른 아이템의 임베딩 $V_j$ 를 검색

---

### Large-scale Retrieval

* 임베딩 공간에서 최근접 이웃을 계산하려면 모든 가능한 후보지에 대해 연산을 해야함. 데이터셋이 큰 경우에는 많은 연산을 요구할 수 있기에 효율성을 위해다음과 같은 방법을 사용하기도 함:
  * 쿼리 임베딩을 고정적으로 알 수 있다면 모든 쿼리에 대해 오프라인에서 미리 연산을 해서 최고의 후보지를 저장. 관련 아이템 추천에서 일반적으로 사용하는 방법
  * 근사 근접 이웃 방법을 사용

---

## Scoring

---

### Scoring 설명

---
